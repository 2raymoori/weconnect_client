{"ast":null,"code":"import _regeneratorRuntime from\"/home/lot/REACT_JS_PROJECTS/weconnectclient/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/lot/REACT_JS_PROJECTS/weconnectclient/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import authToken from\"../utils/authToken\";import{setAlert}from\"./Alert\";import{loadCurPosts,loadOtherPosts}from\"./Post\";import{loadProfiles}from\"./Profile.Action\";var NEW_URL=\"https://weconnect-api-u9ml.onrender.com/\";var oldURL=\"http://localhost:5001/\";//Load User\nexport var loadUser=function loadUser(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){authToken(localStorage.token);}_context.prev=1;_context.next=4;return axios.get(\"\".concat(NEW_URL,\"api/auth\"));case 4:res=_context.sent;console.log(res.data.data[0].msg);dispatch({type:\"USER_LOADED\",payload:res.data.data[0].msg});_context.next=9;return axios.get(\"\".concat(NEW_URL,\"api/profile/me\"));case 9:response=_context.sent;console.log(response.data.data[0]);dispatch({type:\"L_PROFILE\",payload:response.data.data[0]});_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](1);dispatch({type:\"AUTH_ERROR\"});case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,14]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var RegisterUser=function RegisterUser(_ref2){var fName=_ref2.fName,lName=_ref2.lName,email=_ref2.email,password=_ref2.password,passwordConfirm=_ref2.passwordConfirm,profileImage=_ref2.profileImage;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var fomData,config,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;fomData=new FormData();fomData.append(\"fName\",fName);fomData.append(\"lName\",lName);fomData.append(\"email\",email);fomData.append(\"password\",password);fomData.append(\"passwordConfirm\",passwordConfirm);fomData.append(\"pImage\",profileImage);config={headers:{\"Content-Type\":\"multipart/form-data\"}};_context2.next=11;return axios.post(\"\".concat(NEW_URL,\"api/user\"),fomData,{headers:{\"Content-Type\":\"application/json\"}});case 11:res=_context2.sent;dispatch({type:\"REGISTER_SUCCESS\",payload:{token:res.data.data[0].token}});dispatch(loadUser());if(res.status===201){// console.log(\"sdfs\");\nres.data.data.forEach(function(err){dispatch(setAlert(err.msg,\"danger\"));});}// console.log(res.data)\n_context2.next=19;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](0);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[0,17]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;console.log(email+\"::\"+password);console.log(\"FROM XYZZ\");config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({email:email,password:password});_context3.next=7;return axios.post(\"\".concat(NEW_URL,\"api/auth/login\"),body,config);case 7:res=_context3.sent;console.log(res);if(res.data.status==\"Success\"){dispatch({type:\"LOGIN_SUCCESS\",payload:{token:res.data.data[0].msg}});dispatch(loadUser());dispatch(loadProfiles());dispatch(loadCurPosts());dispatch(loadOtherPosts());}else{dispatch(setAlert(\"Sorry There exists an error in your credentials. Please try again or create one if you don't have any\",\"danger\"));}_context3.next=16;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](0);dispatch(setAlert(\"Sorry There exists an error in your credentials. Please try again.\",\"danger\"));dispatch({type:\"LOGIN_FAILED\"});case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[0,12]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){dispatch({type:\"CLEAR_PROFILE\"});dispatch({type:\"LOGOUT\"});};};","map":{"version":3,"names":["axios","authToken","setAlert","loadCurPosts","loadOtherPosts","loadProfiles","NEW_URL","oldURL","loadUser","dispatch","localStorage","token","get","res","console","log","data","msg","type","payload","response","RegisterUser","fName","lName","email","password","passwordConfirm","profileImage","fomData","FormData","append","config","headers","post","status","forEach","err","login","body","JSON","stringify","logout"],"sources":["/home/lot/REACT_JS_PROJECTS/weconnectclient/src/Actions/Auth.js"],"sourcesContent":["import axios from \"axios\";\nimport authToken from \"../utils/authToken\";\nimport { setAlert } from \"./Alert\";\nimport { loadCurPosts, loadOtherPosts } from \"./Post\";\nimport { loadProfiles } from \"./Profile.Action\";\nconst NEW_URL = \"https://weconnect-api-u9ml.onrender.com/\";\nconst oldURL = \"http://localhost:5001/\";\n//Load User\nexport const loadUser = () => async (dispatch) => {\n  if (localStorage.token) {\n    authToken(localStorage.token);\n  }\n  try {\n    const res = await axios.get(`${NEW_URL}api/auth`);\n    console.log(res.data.data[0].msg);\n    dispatch({\n      type: \"USER_LOADED\",\n      payload: res.data.data[0].msg,\n    });\n\n    const response = await axios.get(`${NEW_URL}api/profile/me`);\n    console.log(response.data.data[0]);\n    dispatch({\n      type: \"L_PROFILE\",\n      payload: response.data.data[0],\n    });\n  } catch (error) {\n    dispatch({\n      type: \"AUTH_ERROR\",\n    });\n  }\n};\n\nexport const RegisterUser =\n  ({ fName, lName, email, password, passwordConfirm, profileImage }) =>\n  async (dispatch) => {\n    try {\n      const fomData = new FormData();\n      fomData.append(\"fName\", fName);\n      fomData.append(\"lName\", lName);\n      fomData.append(\"email\", email);\n      fomData.append(\"password\", password);\n      fomData.append(\"passwordConfirm\", passwordConfirm);\n      fomData.append(\"pImage\", profileImage);\n\n      const config = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n        },\n      };\n\n      const res = await axios.post(`${NEW_URL}api/user`, fomData, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      dispatch({\n        type: \"REGISTER_SUCCESS\",\n        payload: { token: res.data.data[0].token },\n      });\n      dispatch(loadUser());\n      if (res.status === 201) {\n        // console.log(\"sdfs\");\n        res.data.data.forEach((err) => {\n          dispatch(setAlert(err.msg, \"danger\"));\n        });\n      }\n      // console.log(res.data)\n    } catch (error) {\n      // console.log(error.message);\n      // console.log(error);\n    }\n  };\n\nexport const login = (email, password) => async (dispatch) => {\n  try {\n    console.log(email + \"::\" + password);\n    console.log(\"FROM XYZZ\");\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    const body = JSON.stringify({\n      email,\n      password,\n    });\n    const res = await axios.post(`${NEW_URL}api/auth/login`, body, config);\n    console.log(res);\n    if (res.data.status == \"Success\") {\n      dispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: { token: res.data.data[0].msg },\n      });\n      dispatch(loadUser());\n      dispatch(loadProfiles());\n      dispatch(loadCurPosts());\n      dispatch(loadOtherPosts());\n    } else {\n      dispatch(\n        setAlert(\n          \"Sorry There exists an error in your credentials. Please try again or create one if you don't have any\",\n          \"danger\"\n        )\n      );\n    }\n  } catch (error) {\n    dispatch(\n      setAlert(\n        \"Sorry There exists an error in your credentials. Please try again.\",\n        \"danger\"\n      )\n    );\n    dispatch({\n      type: \"LOGIN_FAILED\",\n    });\n  }\n};\n\nexport const logout = () => (dispatch) => {\n  dispatch({ type: \"CLEAR_PROFILE\" });\n  dispatch({\n    type: \"LOGOUT\",\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}