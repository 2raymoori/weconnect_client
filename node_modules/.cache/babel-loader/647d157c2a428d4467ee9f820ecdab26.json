{"ast":null,"code":"import axios from \"axios\";\nimport authToken from \"../utils/authToken\";\nimport { setAlert } from \"./Alert\";\nimport { loadCurPosts, loadOtherPosts } from \"./Post\";\nimport { loadProfiles } from \"./Profile.Action\"; // const NEW_URL = \"https://weconnect-api-u9ml.onrender.com/\";\n\nconst NEW_URL = \"https://weconnect-production.up.railway.app/\";\nconst oldURL = \"http://localhost:5001/\"; //Load User\n\nexport const loadUser = () => async dispatch => {\n  if (localStorage.token) {\n    authToken(localStorage.token);\n  }\n\n  try {\n    const res = await axios.get(`${NEW_URL}api/auth`);\n    console.log(res.data.data[0].msg);\n    dispatch({\n      type: \"USER_LOADED\",\n      payload: res.data.data[0].msg\n    });\n    const response = await axios.get(`${NEW_URL}api/profile/me`);\n    console.log(response.data.data[0]);\n    dispatch({\n      type: \"L_PROFILE\",\n      payload: response.data.data[0]\n    });\n  } catch (error) {\n    dispatch({\n      type: \"AUTH_ERROR\"\n    });\n  }\n};\nexport const RegisterUser = _ref => {\n  let {\n    fName,\n    lName,\n    email,\n    password,\n    passwordConfirm,\n    profileImage\n  } = _ref;\n  return async dispatch => {\n    try {\n      const fomData = new FormData();\n      fomData.append(\"fName\", fName);\n      fomData.append(\"lName\", lName);\n      fomData.append(\"email\", email);\n      fomData.append(\"password\", password);\n      fomData.append(\"passwordConfirm\", passwordConfirm);\n      fomData.append(\"pImage\", profileImage);\n      const config = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      };\n      const res = await axios.post(`${NEW_URL}api/user`, fomData, {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      dispatch({\n        type: \"REGISTER_SUCCESS\",\n        payload: {\n          token: res.data.data[0].token\n        }\n      });\n      dispatch(loadUser());\n\n      if (res.status === 201) {\n        // console.log(\"sdfs\");\n        res.data.data.forEach(err => {\n          dispatch(setAlert(err.msg, \"danger\"));\n        });\n      } // console.log(res.data)\n\n    } catch (error) {// console.log(error.message);\n      // console.log(error);\n    }\n  };\n};\nexport const login = (email, password) => async dispatch => {\n  try {\n    console.log(email + \"::\" + password);\n    console.log(\"FROM XYZZ\");\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const body = JSON.stringify({\n      email,\n      password\n    });\n    const res = await axios.post(`${NEW_URL}api/auth/login`, body, config);\n    console.log(res);\n\n    if (res.data.status == \"Success\") {\n      dispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: {\n          token: res.data.data[0].msg\n        }\n      });\n      dispatch(loadUser());\n      dispatch(loadProfiles());\n      dispatch(loadCurPosts());\n      dispatch(loadOtherPosts());\n    } else {\n      dispatch(setAlert(\"Sorry There exists an error in your credentials. Please try again or create one if you don't have any\", \"danger\"));\n    }\n  } catch (error) {\n    dispatch(setAlert(\"Sorry There exists an error in your credentials. Please try again.\", \"danger\"));\n    dispatch({\n      type: \"LOGIN_FAILED\"\n    });\n  }\n};\nexport const logout = () => dispatch => {\n  dispatch({\n    type: \"CLEAR_PROFILE\"\n  });\n  dispatch({\n    type: \"LOGOUT\"\n  });\n};","map":{"version":3,"names":["axios","authToken","setAlert","loadCurPosts","loadOtherPosts","loadProfiles","NEW_URL","oldURL","loadUser","dispatch","localStorage","token","res","get","console","log","data","msg","type","payload","response","error","RegisterUser","fName","lName","email","password","passwordConfirm","profileImage","fomData","FormData","append","config","headers","post","status","forEach","err","login","body","JSON","stringify","logout"],"sources":["/home/lot/REACT_JS_PROJECTS/weconnectclient/src/Actions/Auth.js"],"sourcesContent":["import axios from \"axios\";\nimport authToken from \"../utils/authToken\";\nimport { setAlert } from \"./Alert\";\nimport { loadCurPosts, loadOtherPosts } from \"./Post\";\nimport { loadProfiles } from \"./Profile.Action\";\n// const NEW_URL = \"https://weconnect-api-u9ml.onrender.com/\";\nconst NEW_URL = \"https://weconnect-production.up.railway.app/\";\nconst oldURL = \"http://localhost:5001/\";\n//Load User\nexport const loadUser = () => async (dispatch) => {\n  if (localStorage.token) {\n    authToken(localStorage.token);\n  }\n  try {\n    const res = await axios.get(`${NEW_URL}api/auth`);\n    console.log(res.data.data[0].msg);\n    dispatch({\n      type: \"USER_LOADED\",\n      payload: res.data.data[0].msg,\n    });\n\n    const response = await axios.get(`${NEW_URL}api/profile/me`);\n    console.log(response.data.data[0]);\n    dispatch({\n      type: \"L_PROFILE\",\n      payload: response.data.data[0],\n    });\n\n  } catch (error) {\n    dispatch({\n      type: \"AUTH_ERROR\",\n    });\n  }\n};\n\nexport const RegisterUser =\n  ({ fName, lName, email, password, passwordConfirm, profileImage }) =>\n  async (dispatch) => {\n    try {\n      const fomData = new FormData();\n      fomData.append(\"fName\", fName);\n      fomData.append(\"lName\", lName);\n      fomData.append(\"email\", email);\n      fomData.append(\"password\", password);\n      fomData.append(\"passwordConfirm\", passwordConfirm);\n      fomData.append(\"pImage\", profileImage);\n\n      const config = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n        },\n      };\n\n      const res = await axios.post(`${NEW_URL}api/user`, fomData, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      dispatch({\n        type: \"REGISTER_SUCCESS\",\n        payload: { token: res.data.data[0].token },\n      });\n      dispatch(loadUser());\n      if (res.status === 201) {\n        // console.log(\"sdfs\");\n        res.data.data.forEach((err) => {\n          dispatch(setAlert(err.msg, \"danger\"));\n        });\n      }\n      // console.log(res.data)\n    } catch (error) {\n      // console.log(error.message);\n      // console.log(error);\n    }\n  };\n\nexport const login = (email, password) => async (dispatch) => {\n  try {\n    console.log(email + \"::\" + password);\n    console.log(\"FROM XYZZ\");\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    const body = JSON.stringify({\n      email,\n      password,\n    });\n    const res = await axios.post(`${NEW_URL}api/auth/login`, body, config);\n    console.log(res);\n    if (res.data.status == \"Success\") {\n      dispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: { token: res.data.data[0].msg },\n      });\n      dispatch(loadUser());\n      dispatch(loadProfiles());\n      dispatch(loadCurPosts());\n      dispatch(loadOtherPosts());\n    } else {\n      dispatch(\n        setAlert(\n          \"Sorry There exists an error in your credentials. Please try again or create one if you don't have any\",\n          \"danger\"\n        )\n      );\n    }\n  } catch (error) {\n    dispatch(\n      setAlert(\n        \"Sorry There exists an error in your credentials. Please try again.\",\n        \"danger\"\n      )\n    );\n    dispatch({\n      type: \"LOGIN_FAILED\",\n    });\n  }\n};\n\nexport const logout = () => (dispatch) => {\n  dispatch({ type: \"CLEAR_PROFILE\" });\n  dispatch({\n    type: \"LOGOUT\",\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}